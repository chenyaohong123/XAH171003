<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>选字游戏</title>
	<style>
	 #wrap{
	 	width: 400px;
	 	height:550px;
	 	border:1px solid rgb(107,207,249); 
	 	background: rgb(114,177,224);
	 	box-shadow: 0  0  10px;
	 	border-radius: 50px;
	 	margin: 0 auto;
	 }
	 #nav{
	 	width: 400px;
	 	margin-top: 20px;
	 }
	 #time{
	 	display: inline-block;
	 	margin-left: 20px;
	 }
	 #score{
	 	float: right;
	 	margin-right: 20px;
	 }
	 #content{
	 	width: 400px;
	 	
	 }
	 #bigText{
	 	font-size: 250px;
	 	text-align: center;
	 }
	 #intr{
	 	margin: 0  20px;
	 	font-size: 25px;
	 }
	 #smallText{
	 	font-size: 50px;
	 	margin: 0  30px;
	 }
	</style>
</head>
<body>
	<!-- 容器 -->
	<div id="wrap">
		<!-- 头部 -->
		<div id="nav">
			<div id="time">倒计时：60s</div>
			<div id="score">得分：0</div>
		</div>
		<div id="content">
			<div id="bigText">黄</div>
			<div id="intr">根据上面的字的颜色选择正确的字，选择正确自动开始</div>
		</div>
		<!-- 小字 -->
		<div id="smallText">
			<span class="text">黄</span>
			<span class="text">蓝</span>
			<span class="text">红</span>
			<span class="text">绿</span>
			<span class="text">黑</span>
		</div>
	</div>

	<script>
	//获取游戏所需元素
	var leaveTime  = document.getElementById('time');//倒计时
	var scoreDiv   = document.getElementById('score');//分数
	var bigText    = document.getElementById('bigText');//大字
	var smallTexts = document.getElementsByClassName('text');//小字(集合)

	//随机生成内容
	var charArr  = ['黄','蓝','红','绿','黑'];
	var colorArr = ['yellow','blue','red','green','black'];
	//数组长度为5，元素取值范围[0,4]，元素不重复
	function randomNum(x,y){
		return Math.round(Math.random() * (y - x) + x);
	}
	
	//生成一个下标数组
	function randomIndex(){
		var arr = [];
		while(arr.length < 5){
			var num = randomNum(0,4);
			if(arr.indexOf(num)<0){
				arr.push(num);
			}
		}
		return arr;
	}
	
    //随机创建
     function createCon(){
     	//大字
     	var bigCharIndex  = randomNum(0,4);//下标
     	var bigColorIndex = randomNum(0,4);
     	var c = bigCharIndex;
     	bigText.innerText = charArr[c];//根据随机的下标取出字，为bigText设置文本内容
     	var d = bigColorIndex;
     	bigText.style.color=colorArr[d];

     	//小字
     	//charArr  = ['黄','蓝','红','绿','黑'];
     	var charIndexArr  = randomIndex();//3 1 0 2 4
     	var colorIndexArr = randomIndex();
     	for(var i = 0; i < charIndexArr.length;i++){
     		var a = charIndexArr[i];
     		smallTexts[i].innerText = charArr[a];
     		//             i =  0  1  2  3  4
     		//charIndexArr[i]=  3  1  0  2  4
     		//    colorArr[a]=  绿 蓝 黄  红 黑  

     		var b = colorIndexArr[i];
     		smallTexts[i].style.color = colorArr[b];
     	} 	    

     }
     createCon();
	
	//为每一个小字绑定点击事件
	 var  score = 0 ;//分数
	 var timing = 5;//倒计时
	 var   flag = '1';//倒计时开启开关
	function game(){
        for(var i = 0;i < smallTexts.length;i++){
        	//绑定
        	smallTexts[i].onclick = function(){
        		//this:指向当前函数的所属者
        		//获取当前点击的小字
        		var thisChar = this.innerText;
        		//获取当前点击小字在charArr里的位置
        		var index1   = charArr.indexOf(thisChar);
        		//获取大字的颜色
        		var bigColor = bigText.style.color;
        		//大字颜色在colorArr里的位置
        		var index2   =  colorArr.indexOf(bigColor);
        		//判断是否匹配
        		if(index1 == index2){
        			//点击正确
        		score++ ;//分数累加
        		scoreDiv.innerText = '得分：' + score;
        		createCon();//重新创建内容

	        		//开启倒计时
	        		if(flag == '1'){
	        	    var timer = setInterval(function(){
	        			timing --;//让倒计时累减
	        			//时间为0，提示
	        			leaveTime.innerText = '倒计时' + timing  + 's';
	        			if(timing < 0){
	        				//清除计时器
	        				clearInterval(timer);
	        				alert('时间到');
	        				leaveTime.innerText = '倒计时: 0s';
	        				// //清空所有小盒子的点击事件
	        				// for(var j = 0;j<smallTexts.length;j++){
	        				// 	smallTexts[j].onclick = null;

	        				// }
	        				//重置页面数据使其显示初始化的状态
	        				leaveTime.innerText = '倒计时：60s';
	        				scoreDiv.innerText  = '得分：0';
	        				timing = 60;
	        				score  = 0 ;
	        				game();
	        				flag = '1';
	        			}
	        		},1000);
	        		flag = '0';
        		
        		}
        		
        		}
        	}
        }
	}
	game();
	</script>
</body>
</html>