<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<title>瀑布流复杂版</title>
	<style>
		#list{
			margin: 0  auto;
			position:relative;
		}
		#list img{
			width:200px ;
			position:absolute;
			transition: left 2s, top 1s;	
		}
	</style>
</head>
<body>
	<div id="wrap">
		<div id="list">	
		</div>
	</div>
    <script>
    var list =document.getElementById('list');
    for(var i=0;i<30;i++){
    var newImg = new Image();
    newImg.src = 'img/' + i + '.jpg';	
    list.appendChild(newImg);
    }


    var heightArr = [];
    function getColNum(){
    var windowWidth = document.getElementsByTagName('body')[0].offsetWidth;
    var    num      = Math.floor(windowWidth/220);
    for(var i=0;i<num;i++){
    	heightArr.push(0);
    }
     list.style.width = num*220 + 'px';
    }
    getColNum();

    function getMinIndex(){
    var min;
    for(var i=0;i<heightArr.length;i++){
    	min = min < heightArr[i] ? min:heightArr[i];
    }
    var minIndex = heightArr.indexOf(min);
    return minIndex; 
    }
    getMinIndex();

    function getCss(){
     var imgs = document.getElementsByTagName('img');
     for(var i=0;i<imgs.length;i++){
      var index = getMinIndex();
      imgs[i].style.left = index*220 + 'px';
      imgs[i].style.top  = heightArr[index] + 'px';
      heightArr[index]  += imgs[i].offsetHeight + 20;
     }
    }

    window.onload = function(){
      getCss();
    }

    window.onresize = function(){
    	heightArr=[];
      getColNum();
      getCss();
    }
    </script>
</body>
</html>